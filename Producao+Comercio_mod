{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"eDcyQSISXEur","executionInfo":{"status":"ok","timestamp":1714092195547,"user_tz":180,"elapsed":1737,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import matplotlib.ticker as ticker\n","import matplotlib.pyplot as plt\n","from io import StringIO\n","import seaborn as sn\n","from datetime import date"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"U-OITygafJsM","executionInfo":{"status":"ok","timestamp":1714092195548,"user_tz":180,"elapsed":5,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["#pd.options.display.float_format=\"{:.2f}\".format"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"Kgln35p5Zy2i","executionInfo":{"status":"ok","timestamp":1714092195548,"user_tz":180,"elapsed":4,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["producao_dados=pd.read_csv(\"https://github.com/ArthurNSiqueira/tech_challenge/raw/main/Producao.csv\",\n","                  encoding=\"UTF-8-SIG\",sep=\";\",thousands=\".\",decimal=\",\")"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":479,"status":"ok","timestamp":1714092196023,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"},"user_tz":180},"id":"XpBV4QbWxOsG"},"outputs":[],"source":["producao_dados[\"Categoria\"] = producao_dados[\"id\"]\n","producao_dados[\"Nome Produto\"] = producao_dados[\"produto\"]"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"brKGGXfYgo0z","executionInfo":{"status":"ok","timestamp":1714092196023,"user_tz":180,"elapsed":15,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["producao_dados = producao_dados.set_index('id')"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"p11An3FcqGjO","executionInfo":{"status":"ok","timestamp":1714092196024,"user_tz":180,"elapsed":14,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["producao_ultimos_15_anos = producao_dados.columns[38:]\n","producao_dados_usaveis = producao_dados[producao_ultimos_15_anos]"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":344},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1714092196024,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"},"user_tz":180},"id":"ilZvdzXFqM6i","outputId":"7648d462-79e5-4fdd-b0ba-666a1c11b666"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["         2007       2008       2009       2010       2011       2012  \\\n","id                                                                     \n","1   275287908  287506811  205418206  195267980  257840749  212777037   \n","2   228156220  241057928  164143454  157290088  210113358  175875432   \n","3    42118552   42942053   39211278   35408083   46007504   34938249   \n","4     5013136    3506830    2063474    2569809    1719887    1963356   \n","5    43176484   47334501   39900568   24805713   47598471   45200730   \n","\n","         2013       2014       2015      2016       2017       2018  \\\n","id                                                                    \n","1   196904222  196173123  210308560  86319015  255015187  218375636   \n","2   163111797  157776363  169811472  75279191    1365957  188270142   \n","3    32066403   37438069   39557250  10727099  217527985   29229970   \n","4     1726022     958691     939838    312725   36121245     875524   \n","5    45782530   38464314   37148982  18070626   44537870   38707220   \n","\n","         2019       2020       2021       2022  Categoria  \\\n","id                                                          \n","1   144629737  124200414  173899995  195031611          1   \n","2   121045115  103916391  146075996  162844214          2   \n","3    22032828   19568734   26432799   30198430          3   \n","4     1551794     715289    1391200    1988968          4   \n","5    37615422   32516686   43474998   47511796          5   \n","\n","                     Nome Produto  \n","id                                 \n","1                   VINHO DE MESA  \n","2                           Tinto  \n","3                          Branco  \n","4                          Rosado  \n","5   VINHO FINO DE MESA (VINÍFERA)  "],"text/html":["\n","  <div id=\"df-5392811c-fbb6-483d-8009-88a6785bf6bb\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>2007</th>\n","      <th>2008</th>\n","      <th>2009</th>\n","      <th>2010</th>\n","      <th>2011</th>\n","      <th>2012</th>\n","      <th>2013</th>\n","      <th>2014</th>\n","      <th>2015</th>\n","      <th>2016</th>\n","      <th>2017</th>\n","      <th>2018</th>\n","      <th>2019</th>\n","      <th>2020</th>\n","      <th>2021</th>\n","      <th>2022</th>\n","      <th>Categoria</th>\n","      <th>Nome Produto</th>\n","    </tr>\n","    <tr>\n","      <th>id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>275287908</td>\n","      <td>287506811</td>\n","      <td>205418206</td>\n","      <td>195267980</td>\n","      <td>257840749</td>\n","      <td>212777037</td>\n","      <td>196904222</td>\n","      <td>196173123</td>\n","      <td>210308560</td>\n","      <td>86319015</td>\n","      <td>255015187</td>\n","      <td>218375636</td>\n","      <td>144629737</td>\n","      <td>124200414</td>\n","      <td>173899995</td>\n","      <td>195031611</td>\n","      <td>1</td>\n","      <td>VINHO DE MESA</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>228156220</td>\n","      <td>241057928</td>\n","      <td>164143454</td>\n","      <td>157290088</td>\n","      <td>210113358</td>\n","      <td>175875432</td>\n","      <td>163111797</td>\n","      <td>157776363</td>\n","      <td>169811472</td>\n","      <td>75279191</td>\n","      <td>1365957</td>\n","      <td>188270142</td>\n","      <td>121045115</td>\n","      <td>103916391</td>\n","      <td>146075996</td>\n","      <td>162844214</td>\n","      <td>2</td>\n","      <td>Tinto</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>42118552</td>\n","      <td>42942053</td>\n","      <td>39211278</td>\n","      <td>35408083</td>\n","      <td>46007504</td>\n","      <td>34938249</td>\n","      <td>32066403</td>\n","      <td>37438069</td>\n","      <td>39557250</td>\n","      <td>10727099</td>\n","      <td>217527985</td>\n","      <td>29229970</td>\n","      <td>22032828</td>\n","      <td>19568734</td>\n","      <td>26432799</td>\n","      <td>30198430</td>\n","      <td>3</td>\n","      <td>Branco</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5013136</td>\n","      <td>3506830</td>\n","      <td>2063474</td>\n","      <td>2569809</td>\n","      <td>1719887</td>\n","      <td>1963356</td>\n","      <td>1726022</td>\n","      <td>958691</td>\n","      <td>939838</td>\n","      <td>312725</td>\n","      <td>36121245</td>\n","      <td>875524</td>\n","      <td>1551794</td>\n","      <td>715289</td>\n","      <td>1391200</td>\n","      <td>1988968</td>\n","      <td>4</td>\n","      <td>Rosado</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>43176484</td>\n","      <td>47334501</td>\n","      <td>39900568</td>\n","      <td>24805713</td>\n","      <td>47598471</td>\n","      <td>45200730</td>\n","      <td>45782530</td>\n","      <td>38464314</td>\n","      <td>37148982</td>\n","      <td>18070626</td>\n","      <td>44537870</td>\n","      <td>38707220</td>\n","      <td>37615422</td>\n","      <td>32516686</td>\n","      <td>43474998</td>\n","      <td>47511796</td>\n","      <td>5</td>\n","      <td>VINHO FINO DE MESA (VINÍFERA)</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5392811c-fbb6-483d-8009-88a6785bf6bb')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-5392811c-fbb6-483d-8009-88a6785bf6bb button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5392811c-fbb6-483d-8009-88a6785bf6bb');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-f1242126-67ba-4a89-ae6a-7fe8929aa99d\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f1242126-67ba-4a89-ae6a-7fe8929aa99d')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-f1242126-67ba-4a89-ae6a-7fe8929aa99d button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"producao_dados_usaveis","summary":"{\n  \"name\": \"producao_dados_usaveis\",\n  \"rows\": 51,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 14,\n        \"min\": 1,\n        \"max\": 51,\n        \"num_unique_values\": 51,\n        \"samples\": [\n          44,\n          41,\n          47\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2007\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 50004962,\n        \"min\": 0,\n        \"max\": 275287908,\n        \"num_unique_values\": 25,\n        \"samples\": [\n          30136844,\n          111200,\n          275287908\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2008\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 52887906,\n        \"min\": 0,\n        \"max\": 287506811,\n        \"num_unique_values\": 26,\n        \"samples\": [\n          35647994,\n          220120,\n          287506811\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2009\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 38037817,\n        \"min\": 0,\n        \"max\": 205418206,\n        \"num_unique_values\": 23,\n        \"samples\": [\n          335850,\n          16034003,\n          205418206\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2010\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 36181490,\n        \"min\": 0,\n        \"max\": 195267980,\n        \"num_unique_values\": 27,\n        \"samples\": [\n          50125944,\n          10125,\n          26887259\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2011\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 49003037,\n        \"min\": 0,\n        \"max\": 257840749,\n        \"num_unique_values\": 24,\n        \"samples\": [\n          69364324,\n          2749540,\n          257840749\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2012\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 42960744,\n        \"min\": 0,\n        \"max\": 212777037,\n        \"num_unique_values\": 25,\n        \"samples\": [\n          70066732,\n          2798908,\n          212777037\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2013\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 38089760,\n        \"min\": 0,\n        \"max\": 196904222,\n        \"num_unique_values\": 27,\n        \"samples\": [\n          64879790,\n          30275,\n          33673396\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2014\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 37982768,\n        \"min\": 0,\n        \"max\": 196173123,\n        \"num_unique_values\": 29,\n        \"samples\": [\n          142850,\n          234725,\n          62907281\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2015\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 43530934,\n        \"min\": 0,\n        \"max\": 210308560,\n        \"num_unique_values\": 27,\n        \"samples\": [\n          87894468,\n          23750,\n          52233155\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2016\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 19403148,\n        \"min\": 0,\n        \"max\": 86319015,\n        \"num_unique_values\": 26,\n        \"samples\": [\n          42210389,\n          740395,\n          86319015\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2017\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 50842599,\n        \"min\": 0,\n        \"max\": 255015187,\n        \"num_unique_values\": 28,\n        \"samples\": [\n          46865626,\n          110820,\n          77161971\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2018\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 43798130,\n        \"min\": 0,\n        \"max\": 218375636,\n        \"num_unique_values\": 28,\n        \"samples\": [\n          34367996,\n          25367,\n          65467906\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2019\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 38338729,\n        \"min\": 0,\n        \"max\": 144629737,\n        \"num_unique_values\": 33,\n        \"samples\": [\n          25996,\n          52176,\n          99485\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2020\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 29146188,\n        \"min\": 0,\n        \"max\": 124200414,\n        \"num_unique_values\": 35,\n        \"samples\": [\n          48678,\n          0,\n          46000\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2021\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 45710748,\n        \"min\": 0,\n        \"max\": 173899995,\n        \"num_unique_values\": 40,\n        \"samples\": [\n          2000,\n          11950,\n          70091\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2022\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 43520443,\n        \"min\": 0,\n        \"max\": 195031611,\n        \"num_unique_values\": 29,\n        \"samples\": [\n          4300,\n          27200,\n          589094\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Categoria\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 14,\n        \"min\": 1,\n        \"max\": 51,\n        \"num_unique_values\": 51,\n        \"samples\": [\n          44,\n          41,\n          47\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nome Produto\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 48,\n        \"samples\": [\n          \"Compostos\",\n          \"Vinho Composto\",\n          \"Licorosos\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":7}],"source":["producao_dados_usaveis.head()"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"Q4flhBGESwcB","executionInfo":{"status":"ok","timestamp":1714092196024,"user_tz":180,"elapsed":11,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["producao_dados_usaveis=producao_dados_usaveis[[\"Nome Produto\",'Categoria', '2007', '2008', '2009', '2010', '2011', '2012',\n","       '2013', '2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021',\n","       '2022']]"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":344},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1714092196024,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"},"user_tz":180},"id":"fogaRIeUWtCl","outputId":"e4ecbde8-77fa-4e46-d946-65ea9aa9cedf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                     Nome Produto  Categoria       2007       2008       2009  \\\n","id                                                                              \n","1                   VINHO DE MESA          1  275287908  287506811  205418206   \n","2                           Tinto          2  228156220  241057928  164143454   \n","3                          Branco          3   42118552   42942053   39211278   \n","4                          Rosado          4    5013136    3506830    2063474   \n","5   VINHO FINO DE MESA (VINÍFERA)          5   43176484   47334501   39900568   \n","\n","         2010       2011       2012       2013       2014       2015  \\\n","id                                                                     \n","1   195267980  257840749  212777037  196904222  196173123  210308560   \n","2   157290088  210113358  175875432  163111797  157776363  169811472   \n","3    35408083   46007504   34938249   32066403   37438069   39557250   \n","4     2569809    1719887    1963356    1726022     958691     939838   \n","5    24805713   47598471   45200730   45782530   38464314   37148982   \n","\n","        2016       2017       2018       2019       2020       2021       2022  \n","id                                                                              \n","1   86319015  255015187  218375636  144629737  124200414  173899995  195031611  \n","2   75279191    1365957  188270142  121045115  103916391  146075996  162844214  \n","3   10727099  217527985   29229970   22032828   19568734   26432799   30198430  \n","4     312725   36121245     875524    1551794     715289    1391200    1988968  \n","5   18070626   44537870   38707220   37615422   32516686   43474998   47511796  "],"text/html":["\n","  <div id=\"df-e78fece1-d70c-482f-a17d-23b6a0363e93\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Nome Produto</th>\n","      <th>Categoria</th>\n","      <th>2007</th>\n","      <th>2008</th>\n","      <th>2009</th>\n","      <th>2010</th>\n","      <th>2011</th>\n","      <th>2012</th>\n","      <th>2013</th>\n","      <th>2014</th>\n","      <th>2015</th>\n","      <th>2016</th>\n","      <th>2017</th>\n","      <th>2018</th>\n","      <th>2019</th>\n","      <th>2020</th>\n","      <th>2021</th>\n","      <th>2022</th>\n","    </tr>\n","    <tr>\n","      <th>id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>VINHO DE MESA</td>\n","      <td>1</td>\n","      <td>275287908</td>\n","      <td>287506811</td>\n","      <td>205418206</td>\n","      <td>195267980</td>\n","      <td>257840749</td>\n","      <td>212777037</td>\n","      <td>196904222</td>\n","      <td>196173123</td>\n","      <td>210308560</td>\n","      <td>86319015</td>\n","      <td>255015187</td>\n","      <td>218375636</td>\n","      <td>144629737</td>\n","      <td>124200414</td>\n","      <td>173899995</td>\n","      <td>195031611</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Tinto</td>\n","      <td>2</td>\n","      <td>228156220</td>\n","      <td>241057928</td>\n","      <td>164143454</td>\n","      <td>157290088</td>\n","      <td>210113358</td>\n","      <td>175875432</td>\n","      <td>163111797</td>\n","      <td>157776363</td>\n","      <td>169811472</td>\n","      <td>75279191</td>\n","      <td>1365957</td>\n","      <td>188270142</td>\n","      <td>121045115</td>\n","      <td>103916391</td>\n","      <td>146075996</td>\n","      <td>162844214</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Branco</td>\n","      <td>3</td>\n","      <td>42118552</td>\n","      <td>42942053</td>\n","      <td>39211278</td>\n","      <td>35408083</td>\n","      <td>46007504</td>\n","      <td>34938249</td>\n","      <td>32066403</td>\n","      <td>37438069</td>\n","      <td>39557250</td>\n","      <td>10727099</td>\n","      <td>217527985</td>\n","      <td>29229970</td>\n","      <td>22032828</td>\n","      <td>19568734</td>\n","      <td>26432799</td>\n","      <td>30198430</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Rosado</td>\n","      <td>4</td>\n","      <td>5013136</td>\n","      <td>3506830</td>\n","      <td>2063474</td>\n","      <td>2569809</td>\n","      <td>1719887</td>\n","      <td>1963356</td>\n","      <td>1726022</td>\n","      <td>958691</td>\n","      <td>939838</td>\n","      <td>312725</td>\n","      <td>36121245</td>\n","      <td>875524</td>\n","      <td>1551794</td>\n","      <td>715289</td>\n","      <td>1391200</td>\n","      <td>1988968</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>VINHO FINO DE MESA (VINÍFERA)</td>\n","      <td>5</td>\n","      <td>43176484</td>\n","      <td>47334501</td>\n","      <td>39900568</td>\n","      <td>24805713</td>\n","      <td>47598471</td>\n","      <td>45200730</td>\n","      <td>45782530</td>\n","      <td>38464314</td>\n","      <td>37148982</td>\n","      <td>18070626</td>\n","      <td>44537870</td>\n","      <td>38707220</td>\n","      <td>37615422</td>\n","      <td>32516686</td>\n","      <td>43474998</td>\n","      <td>47511796</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e78fece1-d70c-482f-a17d-23b6a0363e93')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-e78fece1-d70c-482f-a17d-23b6a0363e93 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-e78fece1-d70c-482f-a17d-23b6a0363e93');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-bc46a5cb-93a3-40c1-852f-30034229b3b7\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-bc46a5cb-93a3-40c1-852f-30034229b3b7')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-bc46a5cb-93a3-40c1-852f-30034229b3b7 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"producao_dados_usaveis","summary":"{\n  \"name\": \"producao_dados_usaveis\",\n  \"rows\": 51,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 14,\n        \"min\": 1,\n        \"max\": 51,\n        \"num_unique_values\": 51,\n        \"samples\": [\n          44,\n          41,\n          47\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nome Produto\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 48,\n        \"samples\": [\n          \"Compostos\",\n          \"Vinho Composto\",\n          \"Licorosos\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Categoria\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 14,\n        \"min\": 1,\n        \"max\": 51,\n        \"num_unique_values\": 51,\n        \"samples\": [\n          44,\n          41,\n          47\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2007\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 50004962,\n        \"min\": 0,\n        \"max\": 275287908,\n        \"num_unique_values\": 25,\n        \"samples\": [\n          30136844,\n          111200,\n          275287908\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2008\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 52887906,\n        \"min\": 0,\n        \"max\": 287506811,\n        \"num_unique_values\": 26,\n        \"samples\": [\n          35647994,\n          220120,\n          287506811\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2009\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 38037817,\n        \"min\": 0,\n        \"max\": 205418206,\n        \"num_unique_values\": 23,\n        \"samples\": [\n          335850,\n          16034003,\n          205418206\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2010\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 36181490,\n        \"min\": 0,\n        \"max\": 195267980,\n        \"num_unique_values\": 27,\n        \"samples\": [\n          50125944,\n          10125,\n          26887259\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2011\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 49003037,\n        \"min\": 0,\n        \"max\": 257840749,\n        \"num_unique_values\": 24,\n        \"samples\": [\n          69364324,\n          2749540,\n          257840749\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2012\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 42960744,\n        \"min\": 0,\n        \"max\": 212777037,\n        \"num_unique_values\": 25,\n        \"samples\": [\n          70066732,\n          2798908,\n          212777037\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2013\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 38089760,\n        \"min\": 0,\n        \"max\": 196904222,\n        \"num_unique_values\": 27,\n        \"samples\": [\n          64879790,\n          30275,\n          33673396\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2014\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 37982768,\n        \"min\": 0,\n        \"max\": 196173123,\n        \"num_unique_values\": 29,\n        \"samples\": [\n          142850,\n          234725,\n          62907281\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2015\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 43530934,\n        \"min\": 0,\n        \"max\": 210308560,\n        \"num_unique_values\": 27,\n        \"samples\": [\n          87894468,\n          23750,\n          52233155\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2016\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 19403148,\n        \"min\": 0,\n        \"max\": 86319015,\n        \"num_unique_values\": 26,\n        \"samples\": [\n          42210389,\n          740395,\n          86319015\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2017\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 50842599,\n        \"min\": 0,\n        \"max\": 255015187,\n        \"num_unique_values\": 28,\n        \"samples\": [\n          46865626,\n          110820,\n          77161971\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2018\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 43798130,\n        \"min\": 0,\n        \"max\": 218375636,\n        \"num_unique_values\": 28,\n        \"samples\": [\n          34367996,\n          25367,\n          65467906\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2019\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 38338729,\n        \"min\": 0,\n        \"max\": 144629737,\n        \"num_unique_values\": 33,\n        \"samples\": [\n          25996,\n          52176,\n          99485\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2020\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 29146188,\n        \"min\": 0,\n        \"max\": 124200414,\n        \"num_unique_values\": 35,\n        \"samples\": [\n          48678,\n          0,\n          46000\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2021\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 45710748,\n        \"min\": 0,\n        \"max\": 173899995,\n        \"num_unique_values\": 40,\n        \"samples\": [\n          2000,\n          11950,\n          70091\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"2022\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 43520443,\n        \"min\": 0,\n        \"max\": 195031611,\n        \"num_unique_values\": 29,\n        \"samples\": [\n          4300,\n          27200,\n          589094\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":9}],"source":["producao_dados_usaveis.head()"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"cgSi1mcDqdhS","executionInfo":{"status":"ok","timestamp":1714092196024,"user_tz":180,"elapsed":10,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["\n","producao_dados_usaveis[\"Categoria\"] = producao_dados_usaveis[\"Categoria\"].mask(producao_dados_usaveis[\"Categoria\"] >= 15,'derivado')\n"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"0hc-0uJI06bJ","executionInfo":{"status":"ok","timestamp":1714092196025,"user_tz":180,"elapsed":11,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["producao_dados_usaveis[\"Categoria\"] = producao_dados_usaveis[\"Categoria\"].replace([5,6,7,8],\"vinho fino vinífera\")\n","producao_dados_usaveis[\"Categoria\"] = producao_dados_usaveis[\"Categoria\"].replace([9, 10, 11, 12, 13, 14],\"suco\")\n","producao_dados_usaveis[\"Categoria\"] = producao_dados_usaveis[\"Categoria\"].replace([1,2,3,4],\"vinho mesa\")"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"QMhwIoOCftuU","executionInfo":{"status":"ok","timestamp":1714092196025,"user_tz":180,"elapsed":10,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["producao_dados_usaveis = producao_dados_usaveis.drop(1, axis=0)\n","producao_dados_usaveis = producao_dados_usaveis.drop(5, axis=0)\n","producao_dados_usaveis = producao_dados_usaveis.drop(9, axis=0)\n","producao_dados_usaveis = producao_dados_usaveis.drop(15, axis=0)"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"NvPxlrVHn3Ib","executionInfo":{"status":"ok","timestamp":1714092196577,"user_tz":180,"elapsed":562,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["#def formatar(valor):\n","  #return \"{:,.0f}\".format(valor)"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"BTmexxqGosHE","executionInfo":{"status":"ok","timestamp":1714092196578,"user_tz":180,"elapsed":25,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"outputs":[],"source":["##producao_dados_usaveis[\"2007\"] = producao_dados_usaveis[\"2007\"].apply(formatar)\n","##producao_dados_usaveis[\"2008\"] = producao_dados_usaveis[\"2008\"].apply(formatar)\n","##producao_dados_usaveis[\"2009\"] = producao_dados_usaveis[\"2009\"].apply(formatar)\n","##producao_dados_usaveis[\"2010\"] = producao_dados_usaveis[\"2010\"].apply(formatar)\n","##producao_dados_usaveis[\"2011\"] = producao_dados_usaveis[\"2011\"].apply(formatar)\n","##producao_dados_usaveis[\"2012\"] = producao_dados_usaveis[\"2012\"].apply(formatar)\n","##producao_dados_usaveis[\"2013\"] = producao_dados_usaveis[\"2013\"].apply(formatar)\n","##producao_dados_usaveis[\"2014\"] = producao_dados_usaveis[\"2014\"].apply(formatar)\n","##producao_dados_usaveis[\"2015\"] = producao_dados_usaveis[\"2015\"].apply(formatar)\n","##producao_dados_usaveis[\"2016\"] = producao_dados_usaveis[\"2016\"].apply(formatar)\n","##producao_dados_usaveis[\"2017\"] = producao_dados_usaveis[\"2017\"].apply(formatar)\n","##producao_dados_usaveis[\"2018\"] = producao_dados_usaveis[\"2018\"].apply(formatar)\n","##producao_dados_usaveis[\"2019\"] = producao_dados_usaveis[\"2019\"].apply(formatar)\n","##producao_dados_usaveis[\"2020\"] = producao_dados_usaveis[\"2020\"].apply(formatar)\n","##producao_dados_usaveis[\"2021\"] = producao_dados_usaveis[\"2021\"].apply(formatar)\n","##producao_dados_usaveis[\"2022\"] = producao_dados_usaveis[\"2022\"].apply(formatar)"]},{"cell_type":"code","source":["producao_dados_base = pd.melt(producao_dados_usaveis, id_vars=[\"Categoria\",\"Nome Produto\"],var_name=\"Ano\", value_name=\"Total_Produzido\")"],"metadata":{"id":"0ipiogHVHEp-","executionInfo":{"status":"ok","timestamp":1714092196578,"user_tz":180,"elapsed":25,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["producao_dados_base[\"Nome Produto\"] = producao_dados_base[\"Nome Produto\"].str.lower()"],"metadata":{"id":"rcQXuJkYvFH8","executionInfo":{"status":"ok","timestamp":1714092196578,"user_tz":180,"elapsed":25,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["comercio_dados=pd.read_csv(\"https://github.com/ArthurNSiqueira/tech_challenge/raw/main/Comercio.csv\",\n","                  encoding=\"UTF-8-SIG\",sep=\";\",thousands=\".\",decimal=\",\")"],"metadata":{"id":"n3pwCravZqvY","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":25,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["comercio_dados[\"VINHO DE MESA1\"] = comercio_dados[\"VINHO DE MESA\"]\n","comercio_dados[\"Categoria1\"] = comercio_dados[\"1\"]"],"metadata":{"id":"tiu-6S-GmVvU","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":25,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["comercio_dados = comercio_dados.drop('1',axis=1)"],"metadata":{"id":"iUvOiV2XmZ5L","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":25,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis = comercio_dados.T\n","comercio_dados_usaveis.insert(0,column=\"id\",value = ['produto', 'produto.1','1970', '1971', '1972', '1973', '1974', '1975', '1976','1977', '1978', '1979', '1980', '1981', '1982', '1983', '1984', '1985','1986', '1987', '1988', '1989', '1990', '1991', '1992', '1993', '1994','1995', '1996', '1997', '1998', '1999', '2000', '2001', '2002', '2003','2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012','2013', '2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021','2022','Nome Produto','Categoria'])"],"metadata":{"id":"2I2EhlzZmd_z","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":24,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis= comercio_dados_usaveis.set_index(\"id\")"],"metadata":{"id":"DrcGrh8vmgKC","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":24,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis = comercio_dados_usaveis.T"],"metadata":{"id":"x-KDilSmm6Ka","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":24,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":22,"outputs":[]},{"cell_type":"code","source":["comercio_ultimos_15_anos = comercio_dados_usaveis.columns[39:]\n","comercio_dados_usaveis = comercio_dados_usaveis[comercio_ultimos_15_anos]"],"metadata":{"id":"4dlt67jvm6wS","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":23,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis=comercio_dados_usaveis[[\"Nome Produto\",'Categoria', '2007', '2008', '2009', '2010', '2011', '2012',\n","       '2013', '2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021',\n","       '2022']]"],"metadata":{"id":"MsnNIaMTm-6T","executionInfo":{"status":"ok","timestamp":1714092196579,"user_tz":180,"elapsed":23,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].mask(comercio_dados_usaveis[\"Categoria\"] >24,'derivado') #outros produtos comercializados"],"metadata":{"id":"nDrp7gTAm_WT","executionInfo":{"status":"ok","timestamp":1714092196580,"user_tz":180,"elapsed":24,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([5,6,7,8],\"vinho fino vinífera\")\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([9,10],\"derivado\")\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([11,12,13,14],\"vinho especial\")\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([19,20,21,22,23,24],\"suco\")\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([15,16,17,18],\"derivado\") #espumantes\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([11,12,13],\"suco\")\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([14],\"suco\") #suco de uva concentrado nao faz parte da soma do suco de uva\n","comercio_dados_usaveis[\"Categoria\"] = comercio_dados_usaveis[\"Categoria\"].replace([2,3,4],\"vinho mesa\")"],"metadata":{"id":"PJX3hgNknCmM","executionInfo":{"status":"ok","timestamp":1714092196580,"user_tz":180,"elapsed":23,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["comercio_dados_usaveis = comercio_dados_usaveis.drop([3,9,15,17,23], axis=0)"],"metadata":{"id":"JMOf8m3TnFil","executionInfo":{"status":"ok","timestamp":1714092196580,"user_tz":180,"elapsed":23,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":27,"outputs":[]},{"cell_type":"code","source":["##comercio_dados_usaveis[\"2007\"] = comercio_dados_usaveis[\"2007\"].apply(formatar)\n","##comercio_dados_usaveis[\"2008\"] = comercio_dados_usaveis[\"2008\"].apply(formatar)\n","##comercio_dados_usaveis[\"2009\"] = comercio_dados_usaveis[\"2009\"].apply(formatar)\n","##comercio_dados_usaveis[\"2010\"] = comercio_dados_usaveis[\"2010\"].apply(formatar)\n","##comercio_dados_usaveis[\"2011\"] = comercio_dados_usaveis[\"2011\"].apply(formatar)\n","##comercio_dados_usaveis[\"2012\"] = comercio_dados_usaveis[\"2012\"].apply(formatar)\n","##comercio_dados_usaveis[\"2013\"] = comercio_dados_usaveis[\"2013\"].apply(formatar)\n","##comercio_dados_usaveis[\"2014\"] = comercio_dados_usaveis[\"2014\"].apply(formatar)\n","##comercio_dados_usaveis[\"2015\"] = comercio_dados_usaveis[\"2015\"].apply(formatar)\n","##comercio_dados_usaveis[\"2016\"] = comercio_dados_usaveis[\"2016\"].apply(formatar)\n","##comercio_dados_usaveis[\"2017\"] = comercio_dados_usaveis[\"2017\"].apply(formatar)\n","##comercio_dados_usaveis[\"2018\"] = comercio_dados_usaveis[\"2018\"].apply(formatar)\n","##comercio_dados_usaveis[\"2019\"] = comercio_dados_usaveis[\"2019\"].apply(formatar)\n","##comercio_dados_usaveis[\"2020\"] = comercio_dados_usaveis[\"2020\"].apply(formatar)\n","##comercio_dados_usaveis[\"2021\"] = comercio_dados_usaveis[\"2021\"].apply(formatar)\n","##comercio_dados_usaveis[\"2022\"] = comercio_dados_usaveis[\"2022\"].apply(formatar)"],"metadata":{"id":"5jhqqc-_nIz-","executionInfo":{"status":"ok","timestamp":1714092196580,"user_tz":180,"elapsed":23,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","source":["comercio_dados_base = pd.melt(comercio_dados_usaveis, id_vars=[\"Categoria\",\"Nome Produto\"],var_name=\"Ano\", value_name=\"Total_Comercializado\")"],"metadata":{"id":"7AY6iy4anK8m","executionInfo":{"status":"ok","timestamp":1714092196580,"user_tz":180,"elapsed":22,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["comercio_dados_base [\"Nome Produto\"] = comercio_dados_base [\"Nome Produto\"].str.replace('vm_', '')\n","comercio_dados_base [\"Nome Produto\"] = comercio_dados_base [\"Nome Produto\"].str.replace('ve_', '')\n","comercio_dados_base [\"Nome Produto\"] = comercio_dados_base [\"Nome Produto\"].str.replace('es_', '')\n","comercio_dados_base [\"Nome Produto\"] = comercio_dados_base [\"Nome Produto\"].str.replace('su_', '')\n","comercio_dados_base [\"Nome Produto\"] = comercio_dados_base [\"Nome Produto\"].str.replace('ou_', '')\n","comercio_dados_base [\"Nome Produto\"] = comercio_dados_base [\"Nome Produto\"].str.replace('_', ' ')\n","comercio_dados_base[\"Nome Produto\"] = comercio_dados_base[\"Nome Produto\"].str.lower()"],"metadata":{"id":"Z5lF7reqnMdh","executionInfo":{"status":"ok","timestamp":1714092196581,"user_tz":180,"elapsed":23,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":30,"outputs":[]},{"cell_type":"code","source":["comercio_dados_base.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"65XLO3Z6nQiw","executionInfo":{"status":"ok","timestamp":1714092196581,"user_tz":180,"elapsed":22,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}},"outputId":"9b350f7e-9ec3-40a7-d164-7cf389da65a1"},"execution_count":31,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             Categoria Nome Produto   Ano Total_Comercializado\n","0           vinho mesa        tinto  2007            190526781\n","1           vinho mesa       rosado  2007              2252558\n","2           vinho mesa       branco  2007             29122090\n","3  vinho fino vinífera        tinto  2007             13872339\n","4  vinho fino vinífera       rosado  2007               416285"],"text/html":["\n","  <div id=\"df-3ec2556b-519a-4f75-ab12-b972d7b7c754\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Categoria</th>\n","      <th>Nome Produto</th>\n","      <th>Ano</th>\n","      <th>Total_Comercializado</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>vinho mesa</td>\n","      <td>tinto</td>\n","      <td>2007</td>\n","      <td>190526781</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>vinho mesa</td>\n","      <td>rosado</td>\n","      <td>2007</td>\n","      <td>2252558</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>vinho mesa</td>\n","      <td>branco</td>\n","      <td>2007</td>\n","      <td>29122090</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>vinho fino vinífera</td>\n","      <td>tinto</td>\n","      <td>2007</td>\n","      <td>13872339</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>vinho fino vinífera</td>\n","      <td>rosado</td>\n","      <td>2007</td>\n","      <td>416285</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3ec2556b-519a-4f75-ab12-b972d7b7c754')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-3ec2556b-519a-4f75-ab12-b972d7b7c754 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-3ec2556b-519a-4f75-ab12-b972d7b7c754');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-80738084-f8c6-4129-9dc1-d05d3a28b99c\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-80738084-f8c6-4129-9dc1-d05d3a28b99c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-80738084-f8c6-4129-9dc1-d05d3a28b99c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"comercio_dados_base","summary":"{\n  \"name\": \"comercio_dados_base\",\n  \"rows\": 880,\n  \"fields\": [\n    {\n      \"column\": \"Categoria\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"vinho fino vin\\u00edfera\",\n          \"suco\",\n          \"derivado\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nome Produto\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 49,\n        \"samples\": [\n          \"outros vinhos (sem informdetalhada\",\n          \"vinho composto\",\n          \"vinho leve\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Ano\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 16,\n        \"samples\": [\n          \"2007\",\n          \"2008\",\n          \"2012\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Comercializado\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": 0,\n        \"max\": 196562722,\n        \"num_unique_values\": 630,\n        \"samples\": [\n          5115133,\n          1655,\n          26136089\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":31}]},{"cell_type":"code","source":["producao_dados_base.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"5PkM7VxGnSbw","executionInfo":{"status":"ok","timestamp":1714092196581,"user_tz":180,"elapsed":21,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}},"outputId":"17ac8cd5-675a-4763-fd5d-8676dff0ef7f"},"execution_count":32,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             Categoria Nome Produto   Ano  Total_Produzido\n","0           vinho mesa        tinto  2007        228156220\n","1           vinho mesa       branco  2007         42118552\n","2           vinho mesa       rosado  2007          5013136\n","3  vinho fino vinífera        tinto  2007         24786071\n","4  vinho fino vinífera       branco  2007         17598428"],"text/html":["\n","  <div id=\"df-512038be-fd58-4b16-9e17-41e4a3a22d9a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Categoria</th>\n","      <th>Nome Produto</th>\n","      <th>Ano</th>\n","      <th>Total_Produzido</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>vinho mesa</td>\n","      <td>tinto</td>\n","      <td>2007</td>\n","      <td>228156220</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>vinho mesa</td>\n","      <td>branco</td>\n","      <td>2007</td>\n","      <td>42118552</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>vinho mesa</td>\n","      <td>rosado</td>\n","      <td>2007</td>\n","      <td>5013136</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>vinho fino vinífera</td>\n","      <td>tinto</td>\n","      <td>2007</td>\n","      <td>24786071</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>vinho fino vinífera</td>\n","      <td>branco</td>\n","      <td>2007</td>\n","      <td>17598428</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-512038be-fd58-4b16-9e17-41e4a3a22d9a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-512038be-fd58-4b16-9e17-41e4a3a22d9a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-512038be-fd58-4b16-9e17-41e4a3a22d9a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-3916771e-f7c0-4365-9b57-9b22f4d43038\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-3916771e-f7c0-4365-9b57-9b22f4d43038')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-3916771e-f7c0-4365-9b57-9b22f4d43038 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"producao_dados_base","summary":"{\n  \"name\": \"producao_dados_base\",\n  \"rows\": 752,\n  \"fields\": [\n    {\n      \"column\": \"Categoria\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"vinho fino vin\\u00edfera\",\n          \"derivado\",\n          \"vinho mesa\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nome Produto\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 44,\n        \"samples\": [\n          \"pisco\",\n          \"jeropiga\",\n          \"filtrado\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Ano\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 16,\n        \"samples\": [\n          \"2007\",\n          \"2008\",\n          \"2012\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Produzido\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 28729793,\n        \"min\": 0,\n        \"max\": 241057928,\n        \"num_unique_values\": 356,\n        \"samples\": [\n          188270142,\n          164143454,\n          26861009\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":32}]},{"cell_type":"code","source":["consolidado = pd.merge(producao_dados_base,comercio_dados_base,how = \"left\", on = [\"Categoria\",\"Nome Produto\",\"Ano\"])"],"metadata":{"id":"UlA0LvfgnU7A","executionInfo":{"status":"ok","timestamp":1714092196581,"user_tz":180,"elapsed":19,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":33,"outputs":[]},{"cell_type":"code","source":["consolidado"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":2300},"id":"bOti35Oknslk","executionInfo":{"status":"ok","timestamp":1714092196853,"user_tz":180,"elapsed":291,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}},"outputId":"3eaf36a0-62f1-44c4-a348-2cd9fc8a11a7"},"execution_count":34,"outputs":[{"output_type":"execute_result","data":{"text/plain":["               Categoria                               Nome Produto   Ano  \\\n","0             vinho mesa                                      tinto  2007   \n","1             vinho mesa                                     branco  2007   \n","2             vinho mesa                                     rosado  2007   \n","3    vinho fino vinífera                                      tinto  2007   \n","4    vinho fino vinífera                                     branco  2007   \n","..                   ...                                        ...   ...   \n","747             derivado                         espumante orgânico  2022   \n","748             derivado  destilado alcoólico simples de bagaceira   2022   \n","749             derivado                         vinho acidificado   2022   \n","750             derivado             mosto parcialmente fermentado   2022   \n","751             derivado                           outros derivados  2022   \n","\n","     Total_Produzido Total_Comercializado  \n","0          228156220            190526781  \n","1           42118552             29122090  \n","2            5013136              2252558  \n","3           24786071             13872339  \n","4           17598428              7197075  \n","..               ...                  ...  \n","747                0                  597  \n","748             4300                  NaN  \n","749                0                  NaN  \n","750                0                  NaN  \n","751           247228                  NaN  \n","\n","[752 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-0ebe7361-6844-496c-879d-054195e4366e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Categoria</th>\n","      <th>Nome Produto</th>\n","      <th>Ano</th>\n","      <th>Total_Produzido</th>\n","      <th>Total_Comercializado</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>vinho mesa</td>\n","      <td>tinto</td>\n","      <td>2007</td>\n","      <td>228156220</td>\n","      <td>190526781</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>vinho mesa</td>\n","      <td>branco</td>\n","      <td>2007</td>\n","      <td>42118552</td>\n","      <td>29122090</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>vinho mesa</td>\n","      <td>rosado</td>\n","      <td>2007</td>\n","      <td>5013136</td>\n","      <td>2252558</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>vinho fino vinífera</td>\n","      <td>tinto</td>\n","      <td>2007</td>\n","      <td>24786071</td>\n","      <td>13872339</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>vinho fino vinífera</td>\n","      <td>branco</td>\n","      <td>2007</td>\n","      <td>17598428</td>\n","      <td>7197075</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>747</th>\n","      <td>derivado</td>\n","      <td>espumante orgânico</td>\n","      <td>2022</td>\n","      <td>0</td>\n","      <td>597</td>\n","    </tr>\n","    <tr>\n","      <th>748</th>\n","      <td>derivado</td>\n","      <td>destilado alcoólico simples de bagaceira</td>\n","      <td>2022</td>\n","      <td>4300</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>749</th>\n","      <td>derivado</td>\n","      <td>vinho acidificado</td>\n","      <td>2022</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>750</th>\n","      <td>derivado</td>\n","      <td>mosto parcialmente fermentado</td>\n","      <td>2022</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>751</th>\n","      <td>derivado</td>\n","      <td>outros derivados</td>\n","      <td>2022</td>\n","      <td>247228</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>752 rows × 5 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0ebe7361-6844-496c-879d-054195e4366e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-0ebe7361-6844-496c-879d-054195e4366e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-0ebe7361-6844-496c-879d-054195e4366e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-9d49fd36-67fe-4001-ae18-9e4a110a6adc\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-9d49fd36-67fe-4001-ae18-9e4a110a6adc')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-9d49fd36-67fe-4001-ae18-9e4a110a6adc button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_f73aaf1a-1a09-4411-9bb0-4f9529603a4e\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('consolidado')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_f73aaf1a-1a09-4411-9bb0-4f9529603a4e button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('consolidado');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"consolidado","summary":"{\n  \"name\": \"consolidado\",\n  \"rows\": 752,\n  \"fields\": [\n    {\n      \"column\": \"Categoria\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"vinho fino vin\\u00edfera\",\n          \"derivado\",\n          \"vinho mesa\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nome Produto\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 44,\n        \"samples\": [\n          \"pisco\",\n          \"jeropiga\",\n          \"filtrado\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Ano\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 16,\n        \"samples\": [\n          \"2007\",\n          \"2008\",\n          \"2012\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Produzido\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 28729793,\n        \"min\": 0,\n        \"max\": 241057928,\n        \"num_unique_values\": 356,\n        \"samples\": [\n          188270142,\n          164143454,\n          26861009\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Comercializado\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": 0,\n        \"max\": 196562722,\n        \"num_unique_values\": 263,\n        \"samples\": [\n          164219,\n          616904,\n          122525\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["consolidado.info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dytfDw7Z4trU","executionInfo":{"status":"ok","timestamp":1714092196853,"user_tz":180,"elapsed":8,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}},"outputId":"695264f5-37bc-41df-ffe0-a75a0504c9e1"},"execution_count":35,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 752 entries, 0 to 751\n","Data columns (total 5 columns):\n"," #   Column                Non-Null Count  Dtype \n","---  ------                --------------  ----- \n"," 0   Categoria             752 non-null    object\n"," 1   Nome Produto          752 non-null    object\n"," 2   Ano                   752 non-null    object\n"," 3   Total_Produzido       752 non-null    int64 \n"," 4   Total_Comercializado  320 non-null    object\n","dtypes: int64(1), object(4)\n","memory usage: 29.5+ KB\n"]}]},{"cell_type":"code","source":["consolidado[\"Total_Produzido\"] = consolidado.Total_Produzido.astype('int64')"],"metadata":{"id":"09Bep3J946G2","executionInfo":{"status":"ok","timestamp":1714092196853,"user_tz":180,"elapsed":6,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}}},"execution_count":36,"outputs":[]},{"cell_type":"code","source":["consolidado[\"Nome Produto\"].value_counts().sort_index()"],"metadata":{"id":"H81Kl1Yb21xv","executionInfo":{"status":"ok","timestamp":1714092434218,"user_tz":180,"elapsed":4,"user":{"displayName":"Arthur Siqueira","userId":"05319674118825707476"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"3479439f-c0b3-4389-fe1e-b9d3db7aa372"},"execution_count":40,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Nome Produto\n","bagaceira                                    16\n","base champenoise champanha                   16\n","base charmat champanha                       16\n","base espumante                               16\n","base espumante moscatel                      16\n","bebida de uva                                16\n","borra líquida                                16\n","borra seca                                   16\n","branco                                       32\n","brandy                                       16\n","compostos                                    16\n","destilado                                    16\n","destilado alcoólico simples de bagaceira     16\n","espumante                                    16\n","espumante moscatel                           16\n","espumante orgânico                           16\n","filtrado                                     16\n","frisante                                     16\n","jeropiga                                     16\n","licor de bagaceira                           16\n","licorosos                                    16\n","mistelas                                     16\n","mosto concentrado                            16\n","mosto de uva com bagaço                      16\n","mosto dessulfitado                           16\n","mosto parcialmente fermentado                16\n","mosto simples                                16\n","néctar de uva                                16\n","outros derivados                             16\n","pisco                                        16\n","polpa de uva                                 16\n","rosado                                       32\n","suco de uva adoçado                          16\n","suco de uva concentrado                      16\n","suco de uva integral                         16\n","suco de uva orgânico                         16\n","suco de uva reconstituído                    16\n","tinto                                        32\n","vinagre                                      16\n","vinho acidificado                            16\n","vinho composto                               16\n","vinho leve                                   16\n","vinho licoroso                               16\n","vinho orgânico                               16\n","Name: count, dtype: int64"]},"metadata":{},"execution_count":40}]},{"cell_type":"code","source":[],"metadata":{"id":"eG8UC_GA3hdm"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1uU43pP3Wi30POUyCKRs06eTD3peGqY4W","timestamp":1713987031901},{"file_id":"18b4kzSsACLP5pdMGAm2S68F7PcjMCzCr","timestamp":1713980232813},{"file_id":"1n6NQiGAuVflBbXSBIvPF6xoC4lCyxFrh","timestamp":1713651086802}],"authorship_tag":"ABX9TyMqPFXsqVbdG2OcD6i0lUbD"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}